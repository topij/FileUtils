I'm still getting errors.  For example: 

--

E           FileUtils.core.base.StorageError: Failed to save data: Failed to save DataFrame: 'dict' object has no attribute 'to_excel'

../../../miniconda3/envs/semantic-analyzer/lib/python3.9/site-packages/FileUtils/core/file_utils.py:177: StorageError

---

I think one of the problems is that the save_dataframes is expecting

dataframes: Dict[str, pd.DataFrame]

However, we are providing a dictionary

---

data = {'General Parameters': {'column_name_to_analyze': 'content', 'focus_on': 'technical content', 'include_compounds': True, 'language': 'en', ...}}

output_filetype = <OutputFileType.XLSX: 'xlsx'>, output_type = 'parameters', file_name = 'test_params'

---

Also, can you check the way excel files are saved? Is it correctly setting the sheet name (both single and multisheet excel files) if provided. Remember that even if there is only one dataframe (ie. one sheet), but if it's given as the value in a dictionary, the key should be set as the sheet name.

============================================== short test summary info ===============================================

FAILED tests/unit/test_loaders/test_parameter_handler.py::TestParameterHandling::test_parameter_loading - AssertionError: assert 'General Parameters' in ['Sheet1']

FAILED tests/unit/test_loaders/test_parameter_handler.py::TestParameterHandling::test_finnish_parameters - ValueError: Invalid parameter file: Required sheet 'yleiset säännöt' not found. Available sheets: Sheet1

FAILED tests/unit/test_loaders/test_parameter_handler.py::TestParameterHandling::test_parameter_validation - assert 'max_keywords' in "Invalid parameter file: Required sheet 'General Parameters' not found. Available sheets...

FAILED tests/unit/test_loaders/test_parameter_handler.py::TestParameterHandling::test_missing_mandatory_fields - ValueError: Invalid parameter file: Required sheet 'General Parameters' not found. Available sheets: Sheet1

FAILED tests/unit/test_loaders/test_parameter_handler.py::TestParameterHandling::test_empty_parameter_file - ValueError: Invalid parameter file: Required sheet 'General Parameters' not found. Available sheets: Sheet1

FAILED tests/unit/test_loaders/test_parameter_handler.py::TestParameterHandling::test_parameter_updates - ValueError: Invalid parameter file: Required sheet 'General Parameters' not found. Available sheets: Sheet1

FAILED tests/unit/test_semantic_analyzer.py::TestSemanticAnalyzer::test_complete_analysis - FileUtils.core.base.StorageError: Failed to save data: Failed to save DataFrame: 'dict' object has no attribute '...

FAILED tests/unit/test_semantic_analyzer.py::TestSemanticAnalyzer::test_specific_analysis_types - FileUtils.core.base.StorageError: Failed to save data: Failed to save DataFrame: 'dict' object has no attribute '...

FAILED tests/unit/test_semantic_analyzer.py::TestSemanticAnalyzer::test_error_handling - FileUtils.core.base.StorageError: Failed to save data: Failed to save DataFrame: 'dict' object has no attribute '...

FAILED tests/unit/test_semantic_analyzer.py::TestSemanticAnalyzer::test_finnish_analysis - FileUtils.core.base.StorageError: Failed to save data: Failed to save DataFrame: 'dict' object has no attribute '...

FAILED tests/unit/test_semantic_analyzer.py::TestSemanticAnalyzer::test_batch_analysis - FileUtils.core.base.StorageError: Failed to save data: Failed to save DataFrame: 'dict' object has no attribute '...

FAILED tests/unit/test_semantic_analyzer.py::TestSemanticAnalyzer::test_result_saving - ValueError: Invalid parameter file: Required sheet 'General Parameters' not found. Available sheets: Sheet1